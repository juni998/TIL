# 쿠키

<br>

## 쿠키란
- 쿠키는 웹 브라우저가 보관하는 데이터이다
- 쿠키는 웹 서버와 웹 브라우저 양쪽에서 생성할 수 있다
  - JSP에서 생성하는 쿠키는 웹 서버에서 생성하는 쿠키이다

<br>

## 쿠키의 동작 방식
### 쿠키 생성 단계
- JSP 에서 쿠키는 웹 서버 측에서 생성한다 
- 생성한 쿠키를 응답 데이터의 헤더에 저장해서 웹 브라우저에 전송한다

<br>

### 쿠키 저장 단계
- 웹 브라우저는 응답 데이터에 포함된 쿠키를 쿠키 저장소에 보관한다 
- 쿠키의 종류에 따라 메모리나 파일에 저장한다

<br>

### 쿠키 전송 단계
- 웹 브라우저는 저장한 쿠키를 요청이 있을 때마다 웹 서버에 전송한다
- 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해서 필요한 작업을 수행한다

<br>

웹 브라우저에 쿠키가 저장되면, 쿠키가 삭제되기 전까지 웹 서버에 쿠키를 전송한다
<br>

따라서 웹 어플리케이션을 사용하는 동안 지속적으로 유지해야 하는 정보는 쿠키를 사용해서 저장한다

<br>

## 쿠키의 구성
- 이름 : 각각의 쿠키를 구별하는 데 사용되는 이름
- 값 : 쿠키의 이름과 관련된 값
- 유효시간 : 쿠키의 유지 시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 쿠키를 전송할 요청 경로

<br>

### 쿠키 생성 방법

```
Cookie cookie = new Cookie("name", URLEncoder.encode("아무개", "utf-8");
response.addCookie(cookie);
```

<br>

- 쿠키 정보를 담고 있는 Cookie 객체 생성
- URLEncoder 클래스를 사용해 쿠키 값을 인코딩
- 응답 데이터에 쿠키를 추가

<br>

### 쿠키 값 읽어오기
```
Cookie[] cookies = request.getCookies();
```

<br>

쿠키 값이 존재하지 않으면 `null`을 리턴한다
- `null` 여부를 확인하지 않고 쿠키를 사용하면 `NullPointerException`이 발생할 수 있다

<br>

## 쿠키의 도메인
- 기본적으로 쿠키는 그 쿠키를 생성한 서버에만 전송된다
  - 예시 : http://www.naver.com/에 연결해서 생성된 쿠키는 해당 URL에 연결할 때에만 전송된다
  
<br>

### 같은 도메인을 사용하는 모든 서버에 쿠키를 보내야 할 때
`setDomain()` 메소드 사용
- .naver.com : 점(.)으로 시작하는 경우 관련 도메인에 모두 쿠키를 전송한다
  - 예시 : `.naver.com`으로 설정하면 `mail.naver.com`, `www.naver.com`, `news.naver.com` 등 모두 쿠키를 전송한다
- www.naver.com : 특정 도메인에 대해서만 쿠키를 전송한다

<br>

#### 도메인 지정할 때 주의 점
- 현재 서버의 도메인 및 상위 도메인만 전달할 수 있다

<br>


