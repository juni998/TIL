# 관심사의 분리
<br>

## 관심사의 분리란
> - 관심이 같은 것은 모으고 다른 것은 분리시키는 개념   
> - 하나의 모듈은 한 가지의 책임을 가져아 한다
<br>

## 관심사의 분리가 필요한 이유
> 모든 것을 한데 모으는 편이 처음엔 쉽고 편하다 언젠가 그 뭉쳐 있는 여러 종류의 관심사를 분리해야할 때 많은 수정이 필요하게 된다
<br>

## 예시
> User와 UserDao를 만들고 이를 DB와 연결하여 생성과 조회를 할 때
<br>

User 엔티티 생성
```java
@Getter
@Setter
public class User {
    String id;
    String name;
    String password;

}
```
<br>

### 관심사 분리 없이 UserDAO와 삽입 조회 메소드 생성
```java
public class UserDao {
    //삽입
    public void add(User user) throws ClassNotFoundException, SQLException {
        //중복 코드
        Class.forName("org.h2.Driver");
        Connection c = DriverManager.getConnection(
                "jdbc:h2:tcp://localhost/~/springbook", "sa", ""
        );

        PreparedStatement ps = c.prepareStatement(
                    "insert into members(id, name, password) values(?,?,?)"
        );
        
        ps.setString(1, user.getId());
        ps.setString(2, user.getName());
        ps.setString(3, user.getPassword());

        ps.executeUpdate();

        ps.close();
        c.close();
    }
    
    //조회
    public User get(String id) throws ClassNotFoundException, SQLException {
        //중복코드
        Class.forName("org.h2.Driver");
        Connection c = DriverManager.getConnection(
                "jdbc:h2:tcp://localhost/~/springbook", "sa", ""
        );

        PreparedStatement ps = c.prepareStatement(
                "select * from members where id = ?"
        );
        ps.setString(1, id);

        ResultSet rs = ps.executeQuery();
        rs.next();
        User user = new User();
        user.setId(rs.getString("id"));
        user.setName(rs.getString("name"));
        user.setPassword(rs.getString("password"));

        rs.close();
        ps.close();
        c.close();

        return user;
    }
}
```
<br>

### 관심사 분리를 하여 리팩토링
```java
public class UserDao {
    //삽입
    public void add(User user) throws ClassNotFoundException, SQLException {
        //DB 연결 기능이 필요하면 getConnection() 메소드를 이용
        Connection c = getConnection();

        PreparedStatement ps = c.prepareStatement(
                    "insert into members(id, name, password) values(?,?,?)"
        );
        ps.setString(1, user.getId());
        ps.setString(2, user.getName());
        ps.setString(3, user.getPassword());

        ps.executeUpdate();

        ps.close();
        c.close();
    }
    //조회
    public User get(String id) throws ClassNotFoundException, SQLException {
        Connection c = getConnection();

        PreparedStatement ps = c.prepareStatement(
                "select * from members where id = ?"
        );
        ps.setString(1, id);

        ResultSet rs = ps.executeQuery();
        rs.next();
        User user = new User();
        user.setId(rs.getString("id"));
        user.setName(rs.getString("name"));
        user.setPassword(rs.getString("password"));

        rs.close();
        ps.close();
        c.close();

        return user;
    }

    //중복된 코드를 독립적인 메소드로 만들어서 중복을 제거한다
    private Connection getConnection() throws ClassNotFoundException, SQLException;{
        Class.forName("org.h2.Driver");
       
        return DriverManager.getConnection(
                "jdbc:h2:tcp://localhost/~/springbook", "sa", ""
        );
    }
}

```
<br>

- 관심사 분리를 하지 않으면 UserDAO에서 DB에 커넥션을 연결하는 로직이 삽입, 조회 앞으로 생길 메소드마다 중복으로 등장하게 된다
- 관심사 분리를 하여 중복된 커넥션 로직을 독립적인 메소드를 만들어서 중복을 제거하였다
<br>

### 관심사 분리가 필요한 이유
DB가 MySQL로 변경 되거나 ID,PASSWORD가 변경됐을때 커넥션 로직이 들어간 모든 메소드를 일일이 수정해야 하지만,
관심사 분리를 활용하면 `getConnection()`메소드 하나만 수정해주면 된다
